(this["webpackJsonpmy-project"]=this["webpackJsonpmy-project"]||[]).push([[0],{116:function(e,t,n){},122:function(e,t){},123:function(e,t,n){},124:function(e,t,n){},125:function(e,t,n){},130:function(e,t){},140:function(e,t){},185:function(e,t,n){},187:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(27),s=n.n(a),o=(n(116),n(8)),i=n(11),l=n(6),u=n(41),j=n(7),d=n(196),b=n(194),p=n(198),O=n(197),m=n(109),h=n(108),x=n(195),f=n(193),w=n(199),v=n(1),g=function(e){var t=e.address,n=e.amount,r=e.destroy;return t?Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)(x.a,{children:[Object(v.jsx)(x.a.Toggle,{variant:"light",align:"end",id:"dropdown-basic",className:"d-flex align-items-center border rounded-pill py-1",children:n?Object(v.jsxs)(v.Fragment,{children:[n," ",Object(v.jsx)("span",{className:"ms-1",children:"NEAR"})]}):Object(v.jsx)(f.a,{animation:"border",size:"sm",className:"opacity-25"})}),Object(v.jsxs)(x.a.Menu,{className:"shadow-lg border-0",children:[Object(v.jsx)(x.a.Item,{href:"https://explorer.testnet.near.org/accounts/".concat(t),target:"_blank",children:Object(v.jsxs)(w.a,{direction:"horizontal",gap:2,children:[Object(v.jsx)("i",{className:"bi bi-person-circle fs-4"}),Object(v.jsx)("span",{className:"font-monospace",children:t})]})}),Object(v.jsx)(x.a.Divider,{}),Object(v.jsxs)(x.a.Item,{as:"button",className:"d-flex align-items-center",onClick:function(){r()},children:[Object(v.jsx)("i",{className:"bi bi-box-arrow-right me-2 fs-4"}),"Disconnect"]})]})]})}):null},y=function(e){var t=e.amount,n=e.address,r=e.destroy;return Object(v.jsx)("div",{children:Object(v.jsx)(d.a,{bg:"warning",variant:"dark",expand:"lg",children:Object(v.jsxs)(b.a,{fluid:!0,children:[Object(v.jsx)(d.a.Brand,{href:"#",style:{fontSize:"40px"},children:"Market Arena"}),Object(v.jsx)(d.a.Toggle,{"aria-controls":"navbarScroll"}),Object(v.jsxs)(d.a.Collapse,{id:"navbarScroll",children:[Object(v.jsxs)(p.a,{className:"me-auto my-2 my-lg-0",style:{maxHeight:"100px"},navbarScrollx:!0,children:[Object(v.jsx)(p.a.Link,{children:Object(v.jsx)(u.b,{style:{textDecoration:"none"},to:"/",children:"Home"})}),Object(v.jsx)(p.a.Link,{children:Object(v.jsx)(u.b,{style:{textDecoration:"none"},to:"/new",children:"New"})}),Object(v.jsx)(p.a.Link,{children:Object(v.jsx)(u.b,{style:{textDecoration:"none"},to:"/traders",children:"Traders"})})]}),Object(v.jsx)(g,{address:n,amount:t,destroy:r}),Object(v.jsxs)(O.a,{className:"d-flex",children:[Object(v.jsx)(m.a,{type:"search",placeholder:"Search",className:"me-2","aria-label":"Search"}),Object(v.jsx)(h.a,{variant:"outline-success",children:"Search"})]})]})]})})})},N=n(34),k=n(2),I=1e14;function C(e){return S.apply(this,arguments)}function S(){return(S=Object(i.a)(Object(o.a)().mark((function e(t){var n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(N.parseNearAmount)(t.price+""),t=Object(k.a)(Object(k.a)({},t),{},{price:n}),e.next=4,window.contract.createItem({itemLoad:t});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e,t){return E.apply(this,arguments)}function E(){return(E=Object(i.a)(Object(o.a)().mark((function e(t,n){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.contract.buyItem({itemKey:t},I,n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e){return U.apply(this,arguments)}function U(){return(U=Object(i.a)(Object(o.a)().mark((function e(t){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.contract.getTrader({traderId:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(){return F.apply(this,arguments)}function F(){return(F=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.contract.getAllTraders();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return M.apply(this,arguments)}function M(){return(M=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.contract.getAllItems();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n(123);var B=function(){return Object(v.jsx)("div",{className:"d-flex justify-content-center",children:Object(v.jsx)(f.a,{animation:"border",role:"status",className:"opacity-25",children:Object(v.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})},R=function(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(!1),s=Object(l.a)(a,2),u=s[0],j=s[1],d=window.walletConnection.account(),b=Object(r.useCallback)(Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j(!0),e.t0=c,e.next=5,D();case 5:e.t1=e.sent,(0,e.t0)(e.t1),e.next=12;break;case 9:e.prev=9,e.t2=e.catch(0),console.log({error:e.t2});case 12:return e.prev=12,j(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])})))),p=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t,n){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A(t,n).then((function(){return b()}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log({e:e.t0});case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){b()}),[]),Object(v.jsx)(v.Fragment,{children:u?Object(v.jsx)(B,{}):Object(v.jsx)("div",{className:"main",children:n.map((function(e,t){if(!e.sold)return Object(v.jsxs)("div",{className:"item",children:[Object(v.jsx)("img",{src:e.imageUrl}),Object(v.jsxs)("div",{className:"item-details",children:[Object(v.jsx)("div",{className:"item-name",children:e.name}),Object(v.jsx)("div",{className:"item-description",children:e.description})]}),Object(v.jsx)("hr",{}),Object(v.jsxs)("div",{className:"item-action",children:[Object(v.jsx)("div",{className:"item-owner",children:e.owner}),Object(v.jsx)("button",{className:"item-button",onClick:function(){return p(t,e.price)},children:d.accountId!=e.owner&&"Buy"}),Object(v.jsxs)("div",{className:"item-price",children:[Object(N.formatNearAmount)(e.price)," NEAR"]})]})]})}))})})},G=n(32),z=n(9),H=(n(124),function(){var e=Object(r.useState)(),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)([]),s=Object(l.a)(a,2),u=s[0],j=s[1],d=Object(r.useState)([]),b=Object(l.a)(d,2),p=b[0],O=b[1],m=window.walletConnection.account(),h=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t,n){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("You just gave ".concat(t," ").concat(n," star")),e.prev=1,e.next=4,(r=t,c=n,window.contract.rateTrader({traderId:r,rating:Number(c)})).then((function(){window.location.reload()}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log({e:e.t0});case 9:case"end":return e.stop()}var r,c}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}(),x=Object(r.useCallback)(Object(i.a)(Object(o.a)().mark((function e(){var t;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L();case 3:t=e.sent,j(t),t.forEach(function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(t);case 2:n=e.sent,O((function(e){return[].concat(Object(G.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log({error:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))));Object(r.useEffect)((function(){x()}),[]),Object(r.useEffect)((function(){u.forEach((function(e){c((function(t){return Object(k.a)(Object(k.a)({},t),{},Object(z.a)({},e,1))}))}))}),[u]);return Object(v.jsx)(v.Fragment,{children:p.length>0?Object(v.jsxs)("div",{className:"traders",children:[Object(v.jsx)("div",{className:"traders-heading",children:"All traders who have added goods to this market"}),Object(v.jsxs)("div",{className:"traders-subheading",children:[Object(v.jsx)("span",{children:"Trader ID"}),Object(v.jsx)("span",{children:"Rating"})]}),p.map((function(e,t){return Object(v.jsxs)("div",{className:"trader-row",children:[Object(v.jsxs)("div",{className:"trader",children:[Object(v.jsx)("div",{className:"trader-id",children:e.traderId}),Object(v.jsx)("div",{className:"trader-rating",children:Number(e.rating/e.rateCount||0).toFixed(2)})]}),!e.raters.includes(m.accountId)&&Object(v.jsx)("button",{className:"rate-button",onClick:function(){return function(e){var t=n[e];h(e,t)}(e.traderId)},children:"Rate"}),!e.raters.includes(m.accountId)&&Object(v.jsx)("input",{className:"rate-input",name:"rate-".concat(t),type:"number",min:1,max:5,defaultValue:1,onChange:function(t){return function(e,t){c((function(n){return Object(k.a)(Object(k.a)({},n),{},Object(z.a)({},t,e))}))}(t.target.value,e.traderId)}})]})}))]}):Object(v.jsx)(B,{})})}),P=(n(125),function(){var e=Object(r.useState)(),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(),s=Object(l.a)(a,2),u=s[0],d=s[1],b=Object(r.useState)(),p=Object(l.a)(b,2),m=p[0],x=p[1],f=Object(r.useState)(),w=Object(l.a)(f,2),g=w[0],y=w[1],N=Object(j.f)(),k=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t,n,r,c){var a;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={name:t,imageUrl:n,description:r,price:c},e.prev=1,e.next=4,C(a).then((function(){N("/")}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n,r,c){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{className:"form-new",children:[Object(v.jsx)("div",{className:"form-heading",children:"Add a new item to the arena"}),Object(v.jsx)("div",{className:"form-form",children:Object(v.jsxs)(O.a,{onSubmit:function(e){return function(e){e.preventDefault(),k(n,m,u,g)}(e)},children:[Object(v.jsxs)(O.a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:[Object(v.jsx)(O.a.Label,{children:"Enter name here"}),Object(v.jsx)(O.a.Control,{type:"text",onChange:function(e){return c(e.target.value)}})]}),Object(v.jsxs)(O.a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput2",children:[Object(v.jsx)(O.a.Label,{children:"Enter image link"}),Object(v.jsx)(O.a.Control,{type:"text",onChange:function(e){return x(e.target.value)}})]}),Object(v.jsxs)(O.a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea3",children:[Object(v.jsx)(O.a.Label,{children:"Enter Description"}),Object(v.jsx)(O.a.Control,{as:"textarea",rows:3,onChange:function(e){return d(e.target.value)}})]}),Object(v.jsxs)(O.a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput4",children:[Object(v.jsx)(O.a.Label,{children:"Enter price"}),Object(v.jsx)(O.a.Control,{type:"number",onChange:function(e){return y(e.target.value)}})]}),Object(v.jsx)(h.a,{variant:"dark",type:"button",onClick:function(){return N("/")},children:"Exit"}),Object(v.jsx)(h.a,{variant:"dark",type:"submit",children:"Add"})]})})]})}),W=n.p+"static/media/market-img.62c5f507.jpg",J=function(e){var t=e.name,n=e.login;e.coverImg;return n?Object(v.jsxs)("div",{className:"d-flex justify-content-center flex-column text-center ",style:{background:"#000",minHeight:"100vh"},children:[Object(v.jsxs)("div",{className:"mt-auto text-light mb-5",children:[Object(v.jsx)("div",{className:" ratio ratio-1x1 mx-auto mb-2",style:{maxWidth:"320px"},children:Object(v.jsx)("img",{src:W,alt:""})}),Object(v.jsx)("h1",{children:t}),Object(v.jsx)("p",{children:"Please connect your wallet to continue."}),Object(v.jsx)(h.a,{onClick:n,variant:"outline-light",className:"rounded-pill px-3 mt-3",children:"Connect Wallet"})]}),Object(v.jsx)("p",{className:"mt-auto text-secondary",children:"Powered by NEAR"})]}):null},K="mktarena.mrray.testnet";var q=function(e){switch(e){case"mainnet":return{networkId:"mainnet",nodeUrl:"https://rpc.mainnet.near.org",contractName:K,walletUrl:"https://wallet.near.org",helperUrl:"https://helper.mainnet.near.org",explorerUrl:"https://explorer.mainnet.near.org"};case"testnet":return{networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",contractName:K,walletUrl:"https://wallet.testnet.near.org",helperUrl:"https://helper.testnet.near.org",explorerUrl:"https://explorer.testnet.near.org"};default:throw Error("Unknown environment '".concat(e,"'."))}},V=n(62),Y=q("testnet");function _(){return(_=Object(i.a)(Object(o.a)().mark((function e(){var t;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(V.connect)(Object.assign({deps:{keyStore:new V.keyStores.BrowserLocalStorageKeyStore}},Y));case 2:t=e.sent,window.walletConnection=new V.WalletConnection(t),window.accountId=window.walletConnection.getAccountId(),window.contract=new V.Contract(window.walletConnection.account(),Y.contractName,{viewMethods:["getItem","getTrader","getAllTraders","getAllItems"],changeMethods:["createItem","rateTrader","buyItem"]});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(){return X.apply(this,arguments)}function X(){return(X=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=N.formatNearAmount,e.next=3,window.walletConnection.account().getAccountBalance();case 3:return e.t1=e.sent.total,e.abrupt("return",(0,e.t0)(e.t1,2));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(){window.walletConnection.requestSignIn(Y.contractName)}function $(){window.walletConnection.signOut(),window.location.reload()}n(185);var ee=function(){var e=Object(r.useState)("0"),t=Object(l.a)(e,2),n=t[0],c=t[1],a=window.walletConnection.account(),s=Object(r.useCallback)(Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.accountId){e.next=6;break}return e.t0=c,e.next=4,Q();case 4:e.t1=e.sent,(0,e.t0)(e.t1);case 6:case"end":return e.stop()}}),e)}))));return Object(r.useEffect)((function(){s()}),[s]),Object(v.jsx)("div",{children:a.accountId?Object(v.jsxs)(u.a,{children:[Object(v.jsx)(y,{address:a.accountId,amount:n,destroy:$}),Object(v.jsxs)(j.c,{children:[Object(v.jsx)(j.a,{path:"/",element:Object(v.jsx)(R,{})}),Object(v.jsx)(j.a,{path:"/new",element:Object(v.jsx)(P,{})}),Object(v.jsx)(j.a,{path:"/traders",element:Object(v.jsx)(H,{})})]})]}):Object(v.jsx)(J,{name:"Market Arena",login:Z})})};n(186);window.nearInitPromise=function(){return _.apply(this,arguments)}().then((function(){s.a.render(Object(v.jsx)(c.a.StrictMode,{children:Object(v.jsx)(ee,{})}),document.getElementById("root"))})).catch(console.error)}},[[187,1,2]]]);
//# sourceMappingURL=main.e1adf329.chunk.js.map